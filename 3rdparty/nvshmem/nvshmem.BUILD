load("@//:def.bzl", "cuda_copts")

cc_library(
    name = "nvshmem_host",
    srcs = [
        "usr/lib64/libnvshmem.a",
        "usr/lib64/nvshmem_bootstrap_uid.so",
    ],
    hdrs = [
        "usr/include/host/nvshmem_macros.h",
        "usr/include/host/nvshmem_api.h",
        "usr/include/host/nvshmem_coll_api.h",
        "usr/include/host/nvshmemx_api.h",
        "usr/include/host/nvshmemx_coll_api.h",
        "usr/include/device_host/nvshmem_types.h",
        "usr/include/device_host/nvshmem_proxy_channel.h",
        "usr/include/device_host/nvshmem_common.cuh",
        "usr/include/bootstrap_device_host/nvshmem_uniqueid.h",
        "usr/include/non_abi/nvshmemx_error.h",
        "usr/include/non_abi/nvshmem_version.h",
        "usr/include/non_abi/nvshmem_build_options.h",
        "usr/include/device_host_transport/nvshmem_common_transport.h",
        "usr/include/device_host_transport/nvshmem_common_ibgda.h",
        "usr/include/device_host_transport/nvshmem_constants.h",
        "usr/include/nvshmemx.h",
        "usr/include/nvshmem.h",
    ],
    strip_include_prefix = "usr/include",
    visibility = ["//visibility:public"],
)

cc_library(
    name = "nvshmem_device",
    hdrs = [
        "usr/include/device_host/nvshmem_types.h",
        "usr/include/device_host/nvshmem_proxy_channel.h",
        "usr/include/device_host/nvshmem_common.cuh",
        "usr/include/bootstrap_device_host/nvshmem_uniqueid.h",
        "usr/include/device/nvshmemx_coll_defines.cuh",
        "usr/include/device/nvshmem_device_macros.h",
        "usr/include/device/nvshmem_coll_defines.cuh",
        "usr/include/device/nvshmemx_collective_launch_apis.h",
        "usr/include/device/nvshmemx_defines.h",
        "usr/include/device/nvshmem_defines.h",
        "usr/include/non_abi/device/pt-to-pt/nvshmemi_transfer_api.cuh",
        "usr/include/non_abi/device/wait/nvshmemi_wait_until_apis.cuh",
        "usr/include/non_abi/device/common/nvshmemi_common_device.cuh",
        "usr/include/non_abi/device/team/nvshmemi_team_defines.cuh",
        "usr/include/non_abi/device/threadgroup/nvshmemi_common_device_defines.cuh",
        "usr/include/nvshmemx.h",
        "usr/include/nvshmem.h",
    ],
    strip_include_prefix = "usr/include",
    copts = cuda_copts(),
    visibility = ["//visibility:public"],
)
